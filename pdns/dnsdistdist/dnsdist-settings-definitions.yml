---
global:
  skip-serde: true
  parameters:
    - name: "acl"
      type: "Vec<String>"
      default: "127.0.0.0/8, 10.0.0.0/8, 100.64.0.0/10, 169.254.0.0/16, 192.168.0.0/16, 172.16.0.0/12, ::1/128, fc00::/7, fe80::/10"
      description: "CIDR netmasks of the clients allowed to send DNS queries"
    - name: "backends"
      type: "Vec<BackendConfiguration>"
      default: true
      description: "List of backends"
    - name: "binds"
      type: "Vec<BindConfiguration>"
      default: true
      description: "List of endpoints to accept queries on"
    - name: "cache_hit_response_rules"
      type: "Vec<ResponseRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed on a cache hit"
    - name: "cache_inserted_response_rules"
      type: "Vec<ResponseRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed after inserting a new response into the cache"
    - name: "cache_miss_rules"
      type: "Vec<QueryRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed after a cache miss"
    - name: "cache_settings"
      type: "CacheSettingsConfiguration"
      default: true
      description: "Caching-related settings"
    - name: "console"
      type: "ConsoleConfiguration"
      default: true
      description: "Console-related settings"
    - name: "dynamic_rules"
      type: "Vec<DynamicRulesConfiguration>"
      default: true
      description: "List of dynamic rules"
    - name: "dynamic_rules_settings"
      type: "DynamicRulesSettingsConfiguration"
      default: true
      description: "Dynamic rules-related settings"
    - name: "ebpf"
      type: "EbpfConfiguration"
      default: true
      description: "EBPF settings"
    - name: "edns_client_subnet"
      type: "EdnsClientSubnetConfiguration"
      default: true
      description: "EDNS Client Subnet-related settings"
    - name: "general"
      type: "GeneralConfiguration"
      default: true
      description: "General settings"
    - name: "key_value_stores"
      type: "KeyValueStoresConfiguration"
      default: true
      description: "Key-Value stores"
    - name: "load_balancing_policies"
      type: "LoadBalancingPoliciesConfiguration"
      default: true
      description: "Load-balancing policies"
    - name: "metrics"
      type: "MetricsConfiguration"
      default: true
      description: "Metrics-related settings"
    - name: "packet_caches"
      type: "Vec<PacketCacheConfiguration>"
      default: true
      description: "Packet-cache definitions"
    - name: "pools"
      type: "Vec<PoolConfiguration>"
      default: true
      description: "Pools of backends"
    - name: "proxy_protocol"
      type: "ProxyProtocolConfiguration"
      default: true
      description: "Proxy-protocol-related settings"
    - name: "query_count"
      type: "QueryCountConfiguration"
      default: true
      description: "Queries counting-related settings"
    - name: "query_rules"
      type: "Vec<QueryRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed when a query is received"
    - name: "remote_logging"
      type: "RemoteLoggingConfiguration"
      default: true
      description: "Remote logging-related settings"
    - name: "response_rules"
      type: "Vec<ResponseRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed when a response is received"
    - name: "ring_buffers"
      type: "RingBuffersConfiguration"
      default: true
      description: "In-memory ring buffer settings"
    - name: "security_polling"
      type: "SecurityPollingConfiguration"
      default: true
      description: "Automatic checking of outdated version"
    - name: "selectors"
      type: "Vec<Selector>"
      default: true
      skip-serde: true
      description: "List of selectors that can be reused in rules"
    - name: "self_answered_response_rules"
      type: "Vec<ResponseRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed when a response is generated by DNSdist itself"
    - name: "snmp"
      type: "SnmpConfiguration"
      default: true
      description: "SNMP-related settings"
    - name: "tuning"
      type: "TuningConfiguration"
      default: true
      description: "Performance-related settings"
    - name: "webserver"
      type: "WebserverConfiguration"
      default: true
      description: "Internal web server configuration"
    - name: "xfr_response_rules"
      type: "Vec<ResponseRuleConfiguration>"
      default: true
      skip-serde: true
      description: "List of rules executed when a XFR response is received"
    - name: "xsk"
      type: "Vec<XskConfiguration>"
      default: true
      description: "List of AF_XDP / XSK objects"

metrics:
  parameters:
    - name: "carbon"
      type: "Vec<CarbonConfiguration>"
      default: true

carbon:
  parameters:
    - name: "address"
      type: "String"
      description: "Indicates the IP address where the statistics should be sent"
    - name: "name"
      type: "String"
      default: ""
      description: "An optional string specifying the hostname that should be used. If left empty, the system hostname is used"
    - name: "interval"
      type: u32
      default: 30
      description: "An optional unsigned integer indicating the interval in seconds between exports"
    - name: "namespace"
      rename: "name_space"
      type: "String"
      default: ""
      description: "An optional string specifying the namespace name that should be used"
    - name: "instance"
      type: "String"
      default: ""
      description: "An optional string specifying the instance name that should be used"

remote_logging:
  parameters:
    - name: "protobuf_loggers"
      type: "Vec<ProtobufLoggerConfiguration>"
      default: true
    - name: "dnstap_loggers"
      type: "Vec<DnstapLoggerConfiguration>"
      default: true

protobuf_logger:
  parameters:
    - name: "name"
      type: "String"
    - name: "address"
      type: "String"
      description: "An IP:PORT combination where the logger is listening"
    - name: "timeout"
      type: "u16"
      default: 2
      description: "TCP connect timeout in seconds"
    - name: "max_queued_entries"
      type: "u64"
      default: 100
      description: "Queue this many messages before dropping new ones (e.g. when the remote listener closes the connection)"
    - name: "reconnect_wait_time"
      type: "u8"
      default: 1
      description: "Time in seconds between reconnection attempts"

dnstap_logger:
  parameters:
    - name: "name"
      type: "String"
    - name: "transport"
      type: "String"
    - name: "address"
      type: "String"
    - name: "buffer_hint"
      type: "u64"
      default: 0
    - name: "flush_timeout"
      type: "u64"
      default: 0
    - name: "input_queue_size"
      type: "u64"
      default: 0
    - name: "output_queue_size"
      type: "u64"
      default: 0
    - name: "queue_notify_threshold"
      type: "u64"
      default: 0
    - name: "reopen_interval"
      type: "u64"
      default: 0

ProtoBufMeta:
  parameters:
    - name: "key"
      type: "String"
    - name: "value"
      type: "String"

LMDBKVStore:
  parameters:
    - name: "name"
      type: "String"
    - name: "file_name"
      type: "String"
    - name: "database_name"
      type: "String"
    - name: "no_lock"
      type: "bool"
      default: "false"

CDBKVStore:
  parameters:
    - name: "name"
      type: "String"
    - name: "file_name"
      type: "String"
    - name: "refresh_delay"
      type: "u32"

KVSLookupKeySourceIP:
  parameters:
    - name: "name"
      type: "String"
    - name: "v4_mask"
      type: "u8"
      default: "32"
    - name: "v6_mask"
      type: "u8"
      default: "128"
    - name: "include_port"
      type: "bool"
      default: "false"

KVSLookupKeyQName:
  parameters:
    - name: "name"
      type: "String"
    - name: "wire_format"
      type: "bool"
      default: "true"

KVSLookupKeySuffix:
  parameters:
    - name: "name"
      type: "String"
    - name: "minimum_labels"
      type: "u16"
      default: "0"
    - name: "wire_format"
      type: "bool"
      default: "true"

KVSLookupKeyTag:
  parameters:
    - name: "name"
      type: "String"
    - name: "tag"
      type: "String"

KVSLookupKeys:
  parameters:
    - name: "source_ip_keys"
      type: "Vec<KVSLookupKeySourceIPConfiguration>"
      default: true
    - name: "qname_keys"
      type: "Vec<KVSLookupKeyQNameConfiguration>"
      default: true
    - name: "suffix_keys"
      type: "Vec<KVSLookupKeySuffixConfiguration>"
      default: true
    - name: "tag_keys"
      type: "Vec<KVSLookupKeyTagConfiguration>"
      default: true

key_value_stores:
  parameters:
    - name: "lmdb"
      type: "Vec<LMDBKVStoreConfiguration>"
      default: true
    - name: "cdb"
      type: "Vec<CDBKVStoreConfiguration>"
      default: true
    - name: "lookup_keys"
      type: "KVSLookupKeysConfiguration"
      default: true

webserver:
  parameters:
    - name: "listen_address"
      type: "String"
      default: ""
      description: "IP address and port to listen on"
    - name: "password"
      type: "String"
      default: ""
      description: "The password used to access the internal webserver. Since 1.7.0 the password should be hashed and salted via the ``hashPassword()`` command"
    - name: "api_key"
      type: "String"
      default: ""
      description: "The API Key (set to an empty string do disable it). Since 1.7.0 the key should be hashed and salted via the ``hashPassword()`` command"
    - name: "acl"
      type: "Vec<String>"
      default: "127.0.0.1, ::1"
      description: "List of network masks or IP addresses that are allowed to open a connection to the web server"
    - name: "api_requires_authentication"
      type: "bool"
      default: "true"
      description: "Whether access to the API (/api endpoints) requires a valid API key"
    - name: "stats_require_authentication"
      type: "bool"
      default: "true"
      description: "Whether access to the statistics (/metrics and /jsonstat endpoints) requires a valid password or API key"
    - name: "dashboard_requires_authentication"
      type: "bool"
      default: "true"
      description: "Whether access to the internal dashboard requires a valid password"
    - name: "max_concurrent_connections"
      type: "u32"
      default: 100
      description: "The maximum number of concurrent web connections, or 0 which means an unlimited number"
    - name: "hash_plaintext_credentials"
      type: "bool"
      default: "false"
      description: "Whether passwords and API keys provided in plaintext should be hashed during startup, to prevent the plaintext versions from staying in memory. Doing so increases significantly the cost of verifying credentials"
    - name: "custom_headers"
      type: "Vec<HttpCustomResponseHeaderConfiguration>"
      default: true
    - name: "api_configuration_directory"
      type: "String"
      default: ""
    - name: "api_read_write"
      type: "bool"
      default: "false"

console:
  parameters:
    - name: "listen_address"
      type: "String"
      default: ""
      description: "IP address and port to listen on for console connections"
    - name: "key"
      type: "String"
      default: ""
      description: "The shared secret used to secure connections between the console client and the server, generated via ``makeKey()``"
    - name: "acl"
      type: "Vec<String>"
      default: "127.0.0.1, ::1"
      description: "List of network masks or IP addresses that are allowed to open a connection to the console server"
    - name: "maximum_output_size"
      type: "u32"
      default: "10000000"
      lua-name: "setConsoleOutputMaxMsgSize"
      internal-field-name: "d_consoleOutputMsgMaxSize"
      runtime-configurable: true
    - name: "log_connections"
      type: "bool"
      default: "true"
      lua-name: "setConsoleConnectionsLogging"
      internal-field-name: "d_logConsoleConnections"
      runtime-configurable: true
    - name: "max_concurrent_connections"
      type: "u64"
      default: "0"
      lua-name: "setConsoleMaximumConcurrentConnections"
      internal-field-name: "d_consoleMaxConcurrentConnections"
      runtime-configurable: false

ebpf_map:
  parameters:
    - name: "max_entries"
      type: "u32"
      default: 0
    - name: "pinned_path"
      type: "String"
      default: ""

ebpf:
  parameters:
    - name: "ipv4"
      type: "EbpfMapConfiguration"
      default: true
    - name: "ipv6"
      type: "EbpfMapConfiguration"
      default: true
    - name: "cidr_ipv4"
      type: "EbpfMapConfiguration"
      default: true
    - name: "cidr_ipv6"
      type: "EbpfMapConfiguration"
      default: true
    - name: "qnames"
      type: "EbpfMapConfiguration"
      default: true
    - name: "external"
      type: "bool"
      default: "false"

edns_client_subnet:
  parameters:
    - name: "override_existing"
      lua-name: "setECSOverride"
      internal-field-name: "d_ecsOverride"
      runtime-configurable: true
      type: "bool"
      default: "false"
      description: "When `useClientSubnet` in `newServer()` is set and dnsdist adds an EDNS Client Subnet Client option to the query, override an existing option already present in the query, if any. Please see Passing the source address to the backend for more information. Note that itâ€™s not recommended to enable setECSOverride in front of an authoritative server responding with EDNS Client Subnet information as mismatching data (ECS scopes) can confuse clients and lead to SERVFAIL responses on downstream nameservers"
    - name: "source_prefix_v4"
      lua-name: "setECSSourcePrefixV4"
      internal-field-name: "d_ECSSourcePrefixV4"
      runtime-configurable: true
      type: "u8"
      default: 32
      description: "When `useClientSubnet` in `newServer()` is set and dnsdist adds an EDNS Client Subnet Client option to the query, truncate the requestor's IPv4 address to `prefix` bits"
    - name: "source_prefix_v6"
      lua-name: "setECSSourcePrefixV6"
      internal-field-name: "d_ECSSourcePrefixV6"
      runtime-configurable: true
      type: "u8"
      default: 56
      description: "When `useClientSubnet` in `newServer()` is set and dnsdist adds an EDNS Client Subnet Client option to the query, truncate the requestor's IPv6 address to `prefix` bits"

dynamic_rules_settings:
  parameters:
    - name: "purge_interval"
      type: "u64"
      default: "60"
      lua-name: "setDynBlocksPurgeInterval"
      internal-field-name: "d_dynBlocksPurgeInterval"
      runtime-configurable: true
    - name: "default_action"
      type: "String"
      default: "Drop"

dynamic_rule:
  parameters:
    - name: "type"
      rename: "rule_type"
      type: "String"
    - name: "seconds"
      type: "u32"
    - name: "action_duration"
      type: "u32"
    - name: "comment"
      type: "String"
    - name: "rate"
      type: "u32"
      default: "0"
    - name: "ratio"
      type: "f64"
      default: "0.0"
    - name: "action"
      type: "String"
      default: "drop"
    - name: "warning_rate"
      type: "u32"
      default: "0"
    - name: "warning_ratio"
      type: "f64"
      default: "0.0"
    - name: "tag_name"
      type: "String"
      default: ""
    - name: "tag_value"
      type: "String"
      default: "0"
    - name: "visitor_function_name"
      type: "String"
      default: ""
    - name: "visitor_function_code"
      type: "String"
      default: ""
    - name: "visitor_function_file"
      type: "String"
      default: ""
    - name: "rcode"
      type: "String"
      default: ""
    - name: "qtype"
      type: "String"
      default: ""
    - name: "minimum_number_of_responses"
      type: "u32"
      default: "0"
    - name: "minimum_global_cache_hit_ratio"
      type: "f64"
      default: "0.0"

dynamic_rules:
  parameters:
    - name: "name"
      type: "String"
    - name: "mask_ipv4"
      type: "u8"
      default: "32"
    - name: "mask_ipv6"
      type: "u8"
      default: "64"
    - name: "mask_port"
      type: u8
      default: "0"
    - name: "exclude_ranges"
      type: "Vec<String>"
      default: true
    - name: "include_ranges"
      type: "Vec<String>"
      default: true
    - name: "exclude_domains"
      type: "Vec<String>"
      default: true
    - name: "rules"
      type: "Vec<DynamicRuleConfiguration>"

ring_buffers:
  parameters:
    - name: "size"
      type: "u64"
      default: 10000
      description: "The maximum amount of queries to keep in the ringbuffer"
      lua-name: "setRingBuffersSize"
      internal-field-name: "d_ringsCapacity"
      runtime-configurable: false
    - name: "shards"
      type: "u64"
      default: 10
      description: "The number of shards to use to limit lock contention"
      lua-name: "setRingBuffersSize"
      internal-field-name: "d_ringsNumberOfShards"
      runtime-configurable: false
    - name: "lock_retries"
      type: "u64"
      default: 5
      description: "Set the number of shards to attempt to lock without blocking before giving up and simply blocking while waiting for the next shard to be available. Default to 5 if there is more than one shard, 0 otherwise"
      lua-name: "setRingBuffersOptions"
      internal-field-name: "d_ringsNbLockTries"
      runtime-configurable: false
    - name: "record_queries"
      type: "bool"
      default: "true"
      description: "Whether to record queries in the ring buffers"
      lua-name: "setRingBuffersOptions"
      internal-field-name: "d_ringsRecordQueries"
      runtime-configurable: false
    - name: "record_responses"
      type: "bool"
      default: "true"
      description: "Whether to record responses in the ring buffers"
      lua-name: "setRingBuffersOptions"
      internal-field-name: "d_ringsRecordResponses"
      runtime-configurable: false

incoming_tls_certificate_key_pair:
  parameters:
    - name: "certificate"
      type: "String"
    - name: "key"
      type: "String"
      default: ""
    - name: "password"
      type: "String"
      default: ""

incoming_tls:
  parameters:
    - name: "provider"
      type: "String"
      default: "OpenSSL"
    - name: "certificates"
      type: "Vec<IncomingTlsCertificateKeyPairConfiguration>"
      default: true
    - name: "ignore_errors"
      type: "bool"
      default: "false"
    - name: "ciphers"
      type: "String"
      default: ""
    - name: "ciphers_tls_13"
      type: "String"
      default: ""
    - name: "minimum_version"
      type: "String"
      default: "tls1.0"
    - name: "ticket_key_file"
      type: "String"
      default: ""
    - name: "tickets_keys_rotation_delay"
      type: "u32"
      default: "43200"
    - name: "number_of_tickets_keys"
      type: "u32"
      default: "5"
    - name: "prefer_server_ciphers"
      type: "bool"
      default: "true"
    - name: "session_timeout"
      type: "u32"
      default: "0"
    - name: "session_tickets"
      type: "bool"
      default: "true"
    - name: "number_of_stored_sessions"
      type: "u32"
      default: "20480"
    - name: "ocsp_response_files"
      type: "Vec<String>"
      default: true
    - name: "key_log_file"
      type: "String"
      default: ""
    - name: "release_buffers"
      type: "bool"
      default: "true"
    - name: "enable_renegotiation"
      type: "bool"
      default: "false"
    - name: "async_mode"
      type: "bool"
      default: "false"
    - name: "ktls"
      type: "bool"
      default: "false"
    - name: "read_ahead"
      type: "bool"
      default: "true"
    - name: "proxy_protocol_outside_tls"
      type: "bool"
      default: "false"
    - name: "ignore_configuration_errors"
      type: "bool"
      default: "false"

outgoing_tls:
  parameters:
    - name: "provider"
      type: "String"
      default: "OpenSSL"
    - name: "subject_name"
      type: "String"
      default: ""
    - name: "subject_address"
      type: "String"
      default: ""
    - name: "validate_certificate"
      type: "bool"
      default: "true"
    - name: "ca_store"
      type: "String"
      default: ""
    - name: "ciphers"
      type: "String"
      default: ""
    - name: "ciphers_tls_13"
      type: "String"
      default: ""
    - name: "key_log_file"
      type: "String"
      default: ""
    - name: "release_buffers"
      type: "bool"
      default: "true"
    - name: "enable_renegotiation"
      type: "bool"
      default: "false"
    - name: "ktls"
      type: "bool"
      default: "false"

http_custom_response_header:
  parameters:
    - name: "key"
      type: "String"
    - name: "value"
      type: "String"

http_responses_map:
  parameters:
    - name: "expression"
      type: "String"
    - name: "status"
      type: "u16"
    - name: "content"
      type: "String"
    - name: "headers"
      type: "Vec<HttpCustomResponseHeaderConfiguration>"
      default: true

incoming_doh:
  parameters:
    - name: "provider"
      type: "String"
      default: "nghttp2"
    - name: "paths"
      type: "Vec<String>"
      default: "/dns-query"
    - name: "idle_timeout"
      type: "u64"
      default: 30
    - name: "server_tokens"
      type: "String"
      default: "h2o/dnsdist"
    - name: "send_cache_control_headers"
      type: "bool"
      default: "true"
    - name: "keep_incoming_headers"
      type: "bool"
      default: "false"
    - name: "trust_forwarded_for_header"
      type: "bool"
      default: "false"
    - name: "early_acl_drop"
      type: "bool"
      default: "true"
    - name: "exact_path_matching"
      type: "bool"
      default: "true"
    - name: "internal_pipe_buffer_size"
      type: "u32"
      default: 1048576
    - name: "custom_response_headers"
      type: "Vec<HttpCustomResponseHeaderConfiguration>"
      default: true
    - name: "responses_map"
      type: "Vec<HttpResponsesMapConfiguration>"
      default: true

incoming_doq:
  parameters:
    - name: "max_concurrent_queries_per_connection"
      type: "u64"
      default: 65535

incoming_quic:
  parameters:
    - name: "idle_timeout"
      type: "u64"
      default: 5
    - name: "congestion_control_algorithm"
      type: "String"
      default: "reno"
    - name: "internal_pipe_buffer_size"
      type: "u32"
      default: 1048576

incoming_dnscrypt_certificate_key_pair:
  parameters:
    - name: "certificate"
      type: "String"
    - name: "key"
      type: "String"

incoming_dnscrypt:
  parameters:
    - name: "provider_name"
      type: "String"
      default: ""
    - name: "certificates"
      type: "Vec<IncomingDnscryptCertificateKeyPairConfiguration>"
      default: true

outgoing_doh:
  parameters:
    - name: "path"
      type: "String"
      default: "/dns-query"
    - name: "add_x_forwarded_headers"
      type: "bool"
      default: "false"

incoming_tcp:
  parameters:
    - name: "max_in_flight_queries"
      type: "u32"
      default: 0
    - name: "listen_queue_size"
      type: "u32"
      default: 0
    - name: "fast_open_queue_size"
      type: "u32"
      default: 0
    - name: "max_concurrent_connections"
      type: "u32"
      default: 0

bind:
  parameters:
    - name: "listen_address"
      type: "String"
      description: "Address and port to listen to"
    - name: "reuseport"
      type: "bool"
      default: "false"
    - name: "protocol"
      type: "String"
      default: "Do53"
    - name: "threads"
      type: "u32"
      default: "1"
    - name: "interface"
      type: "String"
      default: ""
    - name: "cpus"
      type: "String"
      default: ""
    - name: "enable_proxy_protocol"
      type: "bool"
      default: "false"
    - name: "tcp"
      type: "IncomingTcpConfiguration"
      default: true
    - name: "tls"
      type: "IncomingTlsConfiguration"
      default: true
    - name: "doh"
      type: "IncomingDohConfiguration"
      default: true
    - name: "doq"
      type: "IncomingDoqConfiguration"
      default: true
    - name: "quic"
      type: "IncomingQuicConfiguration"
      default: true
    - name: "dnscrypt"
      type: "IncomingDnscryptConfiguration"
      default: true
    - name: "additional_addresses"
      type: "Vec<String>"
      default: true
    - name: "xsk"
      type: "String"
      default: ""

outgoing_tcp:
  parameters:
    - name: "connect_timeout"
      type: "u16"
      default: 5
    - name: "send_timeout"
      type: "u16"
      default: 30
    - name: "receive_timeout"
      type: "u16"
      default: 30
    - name: "fast_open"
      type: "bool"
      default: "false"

proxy_protocol_value:
  parameters:
    - name: "key"
      type: "u8"
    - name: "value"
      type: "String"

lazy_health_check:
  parameters:
    - name: "interval"
      type: "u16"
      default: 30
    - name: "min_sample_count"
      type: "u16"
      default: 1
    - name: "mode"
      type: "String"
      default: "TimeoutOrServFail"
    - name: "sample_size"
      type: "u16"
      default: 100
    - name: "threshold"
      type: "u16"
      default: 20
    - name: "use_exponential_back_off"
      type: "bool"
      default: "false"
    - name: "max_back_off"
      type: "u16"
      default: 3600

health_check:
  parameters:
    - name: "mode"
      type: "String"
      default: "auto"
    - name: "qname"
      type: "String"
      default: ""
    - name: "qclass"
      type: "String"
      default: "IN"
    - name: "qtype"
      type: "String"
      default: "A"
    - name: "function"
      type: "String"
      default: ""
    - name: "lua"
      type: "String"
      default: ""
    - name: "lua_file"
      type: "String"
      default: ""
    - name: "timeout"
      type: "u16"
      default: 1000
    - name: "set_cd"
      type: "bool"
      default: "false"
    - name: "max_failures"
      type: "u8"
      default: "1"
    - name: "rise"
      type: "u8"
      default: "1"
    - name: "interval"
      type: "u32"
      default: "1"
    - name: "must_resolve"
      type: "bool"
      default: "false"
    - name: "use_tcp"
      type: "bool"
      default: "false"
    - name: "lazy"
      type: "LazyHealthCheckConfiguration"
      default: true

outgoing_auto_upgrade:
  parameters:
    - name: "enabled"
      type: "bool"
      default: "false"
    - name: "interval"
      type: "u32"
      default: "3600"
    - name: "keep"
      type: "bool"
      default: "false"
    - name: "pool"
      type: "String"
      default: ""
    - name: "doh_key"
      type: "u8"
      default: "7"
    - name: "use_lazy_health_check"
      type: "bool"
      default: "false"

backend:
  parameters:
    - name: "address"
      type: "String"
    - name: "id"
      type: "String"
      default: ""
    - name: "name"
      type: "String"
      default: ""
    - name: "protocol"
      type: "String"
    - name: "tls"
      type: "OutgoingTlsConfiguration"
      default: true
    - name: "doh"
      type: "OutgoingDohConfiguration"
      default: true
    - name: "use_client_subnet"
      type: "bool"
      default: "false"
    - name: "use_proxy_protocol"
      type: "bool"
      default: "false"
    - name: "queries_per_second"
      type: "u32"
      default: 0
    - name: "order"
      type: "u32"
      default: 1
    - name: "weight"
      type: "u32"
      default: 1
    - name: "pools"
      type: "Vec<String>"
      default: true
    - name: "retries"
      type: "u16"
      default: 5
    - name: "tcp"
      type: "OutgoingTcpConfiguration"
      default: true
    - name: "ip_bind_addr_no_port"
      type: "bool"
      default: "true"
    - name: "health_checks"
      type: "HealthCheckConfiguration"
      default: true
    - name: "source"
      type: "String"
      default: ""
    - name: "sockets"
      type: "u32"
      default: "1"
    - name: "disable_zero_scope"
      type: "bool"
      default: "false"
    - name: "reconnect_on_up"
      type: "bool"
      default: "false"
    - name: "max_in_flight"
      type: "u32"
      default: "1"
    - name: "tcp_only"
      type: "bool"
      default: "false"
    - name: "auto_upgrade"
      type: "OutgoingAutoUpgradeConfiguration"
      default: true
    - name: "max_concurrent_tcp_connections"
      type: "u32"
      default: 0
    - name: "ktls"
      type: "bool"
      default: "false"
    - name: "proxy_protocol_advertise_tls"
      type: "bool"
      default: "false"
    - name: "xsk_sockets"
      type: "Vec<String>"
      default: true
    - name: "mac_address"
      type: "String"
      default: ""
    - name: "cpus"
      type: "String"
      default: ""
    - name: "xsk"
      type: "String"
      default: ""

tuning:
  parameters:
    - name: "doh"
      type: "DohTuningConfiguration"
      default: true
    - name: "tcp"
      type: "TcpTuningConfiguration"
      default: true
    - name: "tls"
      type: "TlsTuningConfiguration"
      default: true
    - name: "udp"
      type: "UdpTuningConfiguration"
      default: true

tcp_tuning:
  category: "tuning.tcp"
  parameters:
    - name: "worker_threads"
      type: "u32"
      default: 10
      lua-name: "setMaxTCPClientThreads"
      internal-field-name: "d_maxTCPClientThreads"
      runtime-configurable: false
    - name: "receive_timeout"
      type: "u32"
      default: 2
      lua-name: "setTCPRecvTimeout"
      internal-field-name: "d_tcpRecvTimeout"
      runtime-configurable: true
    - name: "send_timeout"
      type: "u32"
      default: 2
      lua-name: "setTCPSendTimeout"
      internal-field-name: "d_tcpSendTimeout"
      runtime-configurable: true
    - name: "max_queries_per_connection"
      type: "u64"
      default: "0"
      lua-name: "setMaxTCPQueriesPerConnection"
      internal-field-name: "d_maxTCPQueriesPerConn"
      runtime-configurable: true
    - name: "max_connection_duration"
      type: "u64"
      default: "0"
      lua-name: "setMaxTCPConnectionDuration"
      internal-field-name: "d_maxTCPConnectionDuration"
      runtime-configurable: true
    - name: "max_queued_connections"
      type: "u64"
      default: "10000"
      lua-name: "setMaxTCPQueuedConnections"
      internal-field-name: "d_maxTCPQueuedConnections"
      runtime-configurable: false
    - name: "internal_pipe_buffer_size"
      type: "u32"
      default: 1048576
      lua-name: "setTCPInternalPipeBufferSize"
      internal-field-name: "d_tcpInternalPipeBufferSize"
      runtime-configurable: false
    - name: "outgoing_max_idle_time"
      type: "u64"
      default: 300
      lua-name: "setTCPDownstreamMaxIdleTime"
      internal-field-name: "d_outgoingTCPMaxIdleTime"
      runtime-configurable: false
    - name: "outgoing_cleanup_interval"
      type: "u64"
      default: 60
      lua-name: "setTCPDownstreamCleanupInterval"
      internal-field-name: "d_outgoingTCPCleanupInterval"
      runtime-configurable: false
    - name: "outgoing_max_idle_connection_per_backend"
      type: "u64"
      default: 10
      lua-name: "setMaxCachedTCPConnectionsPerDownstream"
      internal-field-name: "d_outgoingTCPMaxIdlePerBackend"
      runtime-configurable: false
    - name: "max_connections_per_client"
      type: "u32"
      default: 0
      lua-name: "setMaxTCPConnectionsPerClient"
      internal-field-name: "d_maxTCPConnectionsPerClient"
      runtime-configurable: false
    - name: "fast_open_key"
      type: "String"
      default: ""
      lua-name: "setTCPFastOpenKey"
      runtime-configurable: false

udp_tuning:
  category: "tuning.udp"
  parameters:
    - name: "messages_per_round"
      type: "u32"
      default: 1
      lua-name: "setUDPMultipleMessagesVectorSize"
      internal-field-name: "d_udpVectorSize"
      runtime-configurable: false
    - name: "send_buffer_size"
      type: "u32"
      default: 0
      lua-name: "setUDPSocketBufferSizes"
      internal-field-name: "d_socketUDPSendBuffer"
      runtime-configurable: false
    - name: "receive_buffer_size"
      type: "u32"
      default: 0
      lua-name: "setUDPSocketBufferSizes"
      internal-field-name: "d_socketUDPRecvBuffer"
      runtime-configurable: false
    - name: "max_outstanding_per_backend"
      type: "u32"
      default: 65535
      lua-name: "setMaxUDPOutstanding"
      internal-field-name: "d_maxUDPOutstanding"
      runtime-configurable: false
    - name: "timeout"
      type: "u8"
      default: 2
      lua-name: "setUDPTimeout"
      internal-field-name: "d_udpTimeout"
      runtime-configurable: false
    - name: "randomize_outgoing_sockets_to_backend"
      type: "bool"
      default: "false"
      lua-name: "setRandomizedOutgoingSockets"
      internal-field-name: "d_randomizeUDPSocketsToBackend"
      runtime-configurable: false
    - name: "randomize_ids_to_backend"
      type: "bool"
      default: "false"
      lua-name: "setRandomizedIdsOverUDP"
      internal-field-name: "d_randomizeIDsToBackend"
      runtime-configurable: false

tls_tuning:
  category: "tuning.tls"
  parameters:
    - name: "outgoing_tickets_cache_cleanup_delay"
      type: "u16"
      default: "60"
      lua-name: "setOutgoingTLSSessionsCacheCleanupDelay"
      internal-field-name: "d_tlsSessionCacheCleanupDelay"
      runtime-configurable: true
    - name: "outgoing_tickets_cache_validity"
      type: "u16"
      default: "600"
      lua-name: "setOutgoingTLSSessionsCacheMaxTicketValidity"
      internal-field-name: "d_tlsSessionCacheSessionValidity"
      runtime-configurable: true
    - name: "max_outgoing_tickets_per_backend"
      type: "u16"
      default: "20"
      lua-name: "setOutgoingTLSSessionsCacheMaxTicketsPerBackend"
      internal-field-name: "d_tlsSessionCacheMaxSessionsPerBackend"
      runtime-configurable: true

doh_tuning:
  category: "tuning.doh"
  parameters:
    - name: "outgoing_worker_threads"
      type: "u32"
      default: 10
      lua-name: "setOutgoingDoHWorkerThreads"
      internal-field-name: "d_outgoingDoHWorkers"
      runtime-configurable: false
    - name: "outgoing_max_idle_time"
      type: "u64"
      default: 300
      lua-name: "setDoHDownstreamMaxIdleTime"
      internal-field-name: "d_outgoingDoHMaxIdleTime"
      runtime-configurable: false
    - name: "outgoing_cleanup_interval"
      type: "u64"
      default: 60
      lua-name: "setDoHDownstreamCleanupInterval"
      internal-field-name: "d_outgoingDoHCleanupInterval"
      runtime-configurable: false
    - name: "outgoing_max_idle_connection_per_backend"
      type: "u64"
      default: 10
      lua-name: "setMaxIdleDoHConnectionsPerDownstream"
      internal-field-name: "d_outgoingDoHMaxIdlePerBackend"
      runtime-configurable: false

cache_settings:
  parameters:
    - name: "stale_entries_ttl"
      type: "u32"
      default: "0"
      lua-name: "setStaleCacheEntriesTTL"
      internal-field-name: "d_staleCacheEntriesTTL"
      runtime-configurable: true
    - name: "cleaning_delay"
      type: "u16"
      default: "60"
      lua-name: "setCacheCleaningDelay"
      internal-field-name: "d_cacheCleaningDelay"
      runtime-configurable: true
    - name: "cleaning_percentage"
      type: "u16"
      default: "100"
      lua-name: "setCacheCleaningPercentage"
      internal-field-name: "d_cacheCleaningPercentage"
      runtime-configurable: true

security_polling:
  parameters:
    - name: "polling_interval"
      type: "u32"
      default: "3600"
      lua-name: "setSecurityPollInterval"
      internal-field-name: "d_secPollInterval"
      runtime-configurable: true
    - name: "suffix"
      type: "String"
      default: "secpoll.powerdns.com."
      lua-name: "setSecurityPollSuffix"
      internal-field-name: "d_secPollSuffix"
      runtime-configurable: true

general:
  parameters:
    - name: "edns_udp_payload_size_self_generated_answers"
      type: "u16"
      default: "1232"
      lua-name: "setPayloadSizeOnSelfGeneratedAnswers"
      internal-field-name: "d_payloadSizeSelfGenAnswers"
      runtime-configurable: true
    - name: "add_edns_to_self_generated_answers"
      type: "bool"
      default: "true"
      lua-name: "setAddEDNSToSelfGeneratedResponses"
      internal-field-name: "d_addEDNSToSelfGeneratedResponses"
      runtime-configurable: true
    - name: "truncate_tc_answers"
      type: "bool"
      default: "false"
      lua-name: "truncateTC"
      internal-field-name: "d_truncateTC"
      runtime-configurable: true
    - name: "fixup_case"
      type: "bool"
      default: "false"
      lua-name: "fixupCase"
      internal-field-name: "d_fixupCase"
      runtime-configurable: true
    - name: "verbose"
      type: "bool"
      default: "false"
      lua-name: "setVerbose"
      internal-field-name: "d_verbose"
      runtime-configurable: true
    - name: "verbose_health_checks"
      type: "bool"
      default: "false"
      lua-name: "setVerboseHealthChecks"
      internal-field-name: "d_verboseHealthChecks"
      runtime-configurable: true
    - name: "allow_empty_responses"
      type: "bool"
      default: "false"
      lua-name: "setAllowEmptyResponse"
      internal-field-name: "d_allowEmptyResponse"
      runtime-configurable: true
    - name: "drop_empty_queries"
      type: "bool"
      default: "false"
      lua-name: "setDropEmptyQueries"
      internal-field-name: "d_dropEmptyQueries"
      runtime-configurable: true
    - name: "capabilities_to_retain"
      type: "Vec<String>"
      default: true
      lua-name: "addCapabilitiesToRetain"
      runtime-configurable: false

packet_cache:
  parameters:
    - name: "name"
      type: "String"
    - name: "size"
      type: "u64"
    - name: "deferrable_insert_lock"
      type: "bool"
      default: "true"
    - name: "dont_age"
      type: "bool"
      default: "false"
    - name: "keep_stale_data"
      type: "bool"
      default: "false"
    - name: "max_negative_ttl"
      type: "u32"
      default: "3600"
    - name: "max_ttl"
      type: "u32"
      default: "86400"
    - name: "min_ttl"
      type: "u32"
      default: 0
    - name: "shards"
      type: "u32"
      default: "20"
    - name: "parse_ecs"
      type: "bool"
      default: "false"
    - name: "stale_ttl"
      type: "u32"
      default: "60"
    - name: "temporary_failure_ttl"
      type: "u32"
      default: "60"
    - name: "cookie_hashing"
      type: "bool"
      default: "false"
    - name: "maximum_entry_size"
      type: "u32"
      default: "0"
    - name: "options_to_skip"
      type: "Vec<String>"
      default: true

proxy_protocol:
  parameters:
    - name: "acl"
      type: "Vec<String>"
      default: ""
    - name: "maximum_payload_size"
      type: "u32"
      default: "512"
      lua-name: "setProxyProtocolMaximumPayloadSize"
      internal-field-name: "d_proxyProtocolMaximumSize"
      runtime-configurable: true
    - name: "apply_acl_to_proxied_clients"
      type: "bool"
      default: "false"
      lua-name: "setProxyProtocolApplyACLToProxiedClients"
      internal-field-name: "d_applyACLToProxiedClients"
      runtime-configurable: true

snmp:
  parameters:
    - name: "enabled"
      type: "bool"
      default: "false"
      lua-name: "snmpAgent"
      internal-field-name: "d_snmpEnabled"
      runtime-configurable: false
    - name: "traps_enabled"
      type: "bool"
      default: "false"
      lua-name: "snmpAgent"
      internal-field-name: "d_snmpTrapsEnabled"
      runtime-configurable: false
    - name: "daemon_socket"
      type: "String"
      default: ""
      lua-name: "snmpAgent"
      internal-field-name: "d_snmpDaemonSocketPath"
      runtime-configurable: false

query_count:
  parameters:
    - name: "enabled"
      type: "bool"
      default: "false"
    - name: "filter_function_name"
      type: "String"
      default: ""
    - name: "filter_function_code"
      type: "String"
      default: ""
    - name: "filter_function_file"
      type: "String"
      default: ""

pool:
  parameters:
    - name: "name"
      type: "String"
    - name: "packet_cache"
      type: "String"
      default: true
    - name: "policy"
      type: "String"
      default: "leastOutstanding"

custom_load_balancing_policy:
  parameters:
    - name: "name"
      type: "String"
    - name: "function_name"
      type: "String"
      default: ""
    - name: "function_code"
      type: "String"
      default: ""
    - name: "function_file"
      type: "String"
      default: ""
    - name: "ffi"
      type: "bool"
      default: "false"
    - name: "per_thread"
      type: "bool"
      default: "false"

load_balancing_policies:
  parameters:
    - name: "default_policy"
      type: "String"
      default: "leastOutstanding"
      lua-name: "setServerPolicy"
      runtime-configurable: true
    - name: "servfail_on_no_server"
      type: "bool"
      default: "false"
      lua-name: "setServFailWhenNoServer"
      internal-field-name: "d_servFailOnNoPolicy"
      runtime-configurable: true
    - name: "round_robin_servfail_on_no_server"
      type: "bool"
      default: "false"
      lua-name: "setRoundRobinFailOnNoServer"
      internal-field-name: "d_roundrobinFailOnNoServer"
      runtime-configurable: true
    - name: "weighted_balancing_factor"
      type: "f64"
      default: 0.0
      lua-name: "setWeightedBalancingFactor"
      internal-field-name: "d_weightedBalancingFactor"
      runtime-configurable: false
    - name: "consistent_hashing_balancing_factor"
      type: "f64"
      default: 0.0
      lua-name: "setConsistentHashingBalancingFactor"
      internal-field-name: "d_consistentHashBalancingFactor"
      runtime-configurable: false
    - name: "custom_policies"
      type: "Vec<CustomLoadBalancingPolicyConfiguration>"
      default: true
    - name: "hash_perturbation"
      type: "u32"
      default: "0"
      lua-name: "setWHashedPertubation"
      internal-field-name: "d_hashPerturbation"
      runtime-configurable: false

query_rule:
  skip-serde: true
  parameters:
    - name: "name"
      type: "String"
    - name: "uuid"
      type: "String"
    - name: "selector"
      type: "Selector"
    - name: "action"
      type: "Action"

response_rule:
  skip-serde: true
  parameters:
    - name: "name"
      type: "String"
    - name: "uuid"
      type: "String"
    - name: "selector"
      type: "Selector"
    - name: "action"
      type: "ResponseAction"

xsk:
  parameters:
    - name: "name"
      type: "String"
    - name: "interface"
      type: "String"
    - name: "queues"
      type: "u16"
    - name: "frames"
      type: "u32"
      default: 65536
    - name: "map_path"
      type: "String"
      default: "/sys/fs/bpf/dnsdist/xskmap"
